# Cheat sheet


### Системная информация
| Команда | Описание |
| --- | --- |
| uname -m | отобразить архитектуру компьютера |
| uname -r | отобразить используемую версию ядра |
| dmidecode -q | показать аппаратные системные компоненты - (SMBIOS / DMI) |
| hdparm -i /dev/sda | вывести характеристики жесткого диска |
| hdparm -tT /dev/sda | протестировать производительность чтения данных с жесткого диска |
| cat /proc/cpuinfo | отобразить информацию о процессоре |
| cat /proc/interrupts | показать прерывания |
| cat /proc/meminfo | проверить использование памяти |
| cat /proc/swaps | показать файл(ы) подкачки |
| cat /proc/version | вывести версию ядра |
| cat /proc/net/dev | показать сетевые интерфейсы и статистику по ним |
| cat /proc/mounts | отобразить смонтированные файловые системы |
| lspci -tv | показать в виде дерева PCI устройства |
| lsusb -tv | показать в виде дерева USB устройства |
| date | вывести системную дату |
| cal 2018 | вывести таблицу-календарь 2018-го года |
| clock -w | сохранить системное время в BIOS |


### Остановка системы
| Команда | Описание |
| --- | --- |
| shutdown -h now | Остановить систему |
| shutdown -h hours:minutes & | запланировать остановку системы на указанное время |
| shutdown -c | отменить запланированную по расписанию остановку системы |
| shutdown -r now | перегрузить систему |
| reboot |
| logout | выйти из системы |


### Файлы и директории
| Команда | Описание |
| --- | --- |
| cd /home | перейти в директорию '/home' |
| cd .. | перейти в директорию уровнем выше |
| cd ../.. | перейти в директорию двумя уровнями выше |
| cd | перейти в домашнюю директорию |
| cd ~user | перейти в домашнюю директорию пользователя user |
| cd - | перейти в директорию, в которой находились до перехода в текущую директорию |
| pwd | показать текущую директорию |
| ls | отобразить содержимое текущей директории |
| ls -F | отобразить содержимое текущей директории с добавлением к именам символов, храктеризующих тип |
| ls -l | показать детализированое представление файлов и директорий в текущей директории |
| ls -a | показать скрытые файлы и директории в текущей директории |
| ls \*[0-9]\* | показать файлы и директории содержащие в имени цифры |
| tree | показать дерево файлов и директорий, начиная от корня (/) |
| mkdir dir1 | создать директорию с именем 'dir1' |
| mkdir dir1 dir2 | создать две директории одновременно |
| mkdir -p /tmp/dir1/dir2 | создать дерево директорий |
| rm -f file1 | удалить файл с именем 'file1' |
| rmdir dir1 | удалить директорию с именем 'dir1' |
| rm -rf dir1 | удалить директорию с именем 'dir1' и рекурсивно всё её содержимое |
| rm -rf dir1 dir2 | удалить две директории и рекурсивно их содержимое |
| mv dir1 new_dir | переименовать или переместить файл или директорию |
| cp file1 file2 | сопировать файл file1 в файл file2 |
| cp dir/\* . | копировать все файлы директории dir в текущую директорию |
| cp -a /tmp/dir1 . | копировать директорию dir1 со всем содержимым в текущую директорию (`-a` same as `-dR`) |
| cp -a dir1 dir2 | копировать директорию dir1 в директорию dir2 |
| ln -s file1 lnk1 | создать символическую ссылку на файл или директорию |
| ln file1 lnk1 | создать "жёсткую" (физическую) ссылку на файл или директорию |
| touch -t 0712250000 fileditest | модифицировать дату и время создания файла, при его отсутствии, создать файл с указанными датой и временем (YYMMDDhhmm) |


### Поиск файлов
| Команда | Описание |
| --- | --- |
| find / -name file1 | найти файлы и директории с именем file1. Поиск начать с корня (/) |
| find / -user user1 | найти файл и директорию принадлежащие пользователю user1. Поиск начать с корня (/) |
| find /home/user1 -name "*.bin" | Найти все файлы и директории, имена которых оканчиваются на '. bin'. Поиск начать с '/ home/user1' |
| find /usr/bin -type f -atime +100 | найти все файлы в '/usr/bin', время последнего обращения к которым более 100 дней |
| find /usr/bin -type f -mtime -10 | найти все файлы в '/usr/bin', созданные или изменённые в течении последних 10 дней |
| find / -name *.rpm -exec chmod 755 '{}' \; | найти все фалы и директории, имена которых оканчиваются на '.rpm', и изменить права доступа к ним |
| find / -xdev -name "*.rpm" | найти все фалы и директории, имена которых оканчиваются на '.rpm', игнорируя съёмные носители, такие как cdrom, floppy и т.п. |
| locate "*.ps" | найти все файлы, сожержащие в имени '.ps'. Предварительно рекомендуется выполнить команду 'updatedb' |
| whereis halt | показывает размещение бинарных файлов, исходных кодов и руководств, относящихся к файлу 'halt' |
| which halt | отображает полный путь к файлу 'halt' |


### Дисковое пространство
| Команда | Описание |
| --- | --- |
| df -h | отображает информацию о смонтированных разделах с отображением общего, доступного и используемого пространства |
| ls -lSR &#124; less | выдаёт список файлов и директорий рекурсивно с сортировкой по возрастанию размера и позволяет осуществлять постраничный просмотр |
| du -sh dir1 | подсчитывает и выводит размер, занимаемый директорией 'dir1' |
| du -sk * &#124; sort -rn | отображает размер и имена файлов и директорий, с соритровкой по размеру |
| dpkg-query -W -f='${Installed-Size;10}\t${Package}\n' &#124; sort -k1,1n | показывает размер используемого дискового пространства, занимаемое файлами deb-пакета, с сортировкой по размеру |
[//]: # (TODO опробовать команду)


### Пользователи и группы
| Команда | Описание |
| --- | --- |
| groupadd group_name | создать новую группу с именем group_name |
| groupdel group_name | удалить группу group_name |
| groupmod -n new_group_name old_group_name | переименовать группу old_group_name в new_group_name |
| useradd -c "Nome Cognome" -g admin -d /home/user1 -s /bin/bash user1 | создать пользователя user1, назначить ему в качестве домашнего каталога /home/user1, в качестве shell'а /bin/bash, включить его в группу admin и добавить комментарий Nome Cognome |
| useradd user1 | создать пользователя user1 |
| userdel -r user1 | удалить пользователя user1 и его домашний каталог |
| usermod -c "User FTP" -g system -d /ftp/user1 -s /bin/nologin user1 | изменить атрибуты пользователя |
| passwd | сменить пароль |
| passwd user1 | сменить пароль пользователя user1 (только root) |
| chage -E 2005-12-31 user1 | установить дату окончания действия учётной записи пользователя user1 |
| pwck | проверить корректность системных файлов учётных записей. Проверяются файлы /etc/passwd и /etc/shadow |
| grpck | проверяет корректность системных файлов учётных записей. Проверяется файл/etc/group |
| newgrp [-] group_name | изменяет первичную группу текущего пользователя. Если указать "-", ситуация будет идентичной той, в которой пользователь вышел из системы и снова вошёл. Если не указывать группу, первичная группа будет назначена из /etc/passwd |


### Выставление/изменение полномочий на файлы
| Команда | Описание |
| --- | --- |
| ls -lh | просмотр полномочий на файлы и директории в текущей директории |
| ls /tmp &#124; pr -T5 -W$COLUMNS | вывести содержимое директории /tmp и разделить вывод на пять колонок |
| chmod ugo+rwx directory1 | добавить полномочия на директорию directory1 ugo(User Group Other)+rwx(Read Write eXecute) - всем полные права. Аналогичное можно сделать таким образом "chmod 777 directory1" |
| chmod go-rwx directory1 | отобрать у группы и всех остальных все полномочия на директорию directory1. |
| chown user1 file1 | назначить владельцем файла file1 пользователя user1 |
| chown -R user1 directory1 | назначить рекурсивно владельцем директории directory1 пользователя user1 |
| chgrp group1 file1 | сменить группу-владельца файла file1 на group1 |
| chown user1:group1 file1 | сменить владельца и группу владельца файла file1 |
| find / -perm -u+s | найти, начиная от корня, все файлы с выставленным SUID |
| chmod u+s /bin/binary_file | назначить SUID-бит файлу /bin/binary_file. Это даёт возможность любому пользователю запускать на выполнение файл с полномочиями владельца файла. |
| chmod u-s /bin/binary_file | снять SUID-бит с файла /bin/binary_file. |
| chmod g+s /home/public | назначить SGID-бит директории /home/public. |
| chmod g-s /home/public | снять SGID-бит с директории /home/public. |
| chmod o+t /home/public | назначить STIKY-бит директории /home/public. Позволяет удалять файлы только владельцам |
| chmod o-t /home/public | снять STIKY-бит с директории /home/public |


### Специальные атрибуты файлов
| Команда | Описание |
| --- | --- |
| chattr +a file1 | позволить открывать файл на запись только в режиме добавления |
| chattr +c file1 | позволяет ядру автоматически сжимать/разжимать содержимое файла. |
| chattr +d file1 | указавет утилите dump игнорировать данный файл во время выполнения backup'а |
| chattr +i file1 | делает файл недоступным для любых изменений: редактирование, удаление, перемещение, создание линков на него. |
| chattr +s file1 | позволяет сделать удаление файла безопасным, т.е. выставленный атрибут s говорит о том, что при удалении файла, место, занимаемое файлом на диске заполняется нулями, что предотвращяет возможность восстановления данных. |
| chattr +S file1 | указывает, что, при сохранении изменений, будет произведена синхронизация, как при выполнении команды sync |
| chattr +u file1 | данный атрибут указывает, что при удалении файла содержимое его будет сохранено и при необходимости пользователь сможет его восстановить |
| lsattr | показать атрибуты файлов |


### Архивирование и сжатие файлов
| Команда | Описание |
| --- | --- |
| gzip file1 | сжимает файл 'file1', заменяя его на 'file.gz' |
| gunzip file1.gz | разжимает файл 'file1.gz', заменяя его на 'file1' |
| tar -cvf archive.tar file1 file2 dir1 | создать tar-архив archive.tar, содержащий файл file1, file2 и dir1 |
| tar -cvzf archive.tar.gz dir1 | создать архив и сжать его с помощью gzip |
| tar -tf archive.tar | показать содержимое архива |
| tar -xvf archive.tar | распаковать архив |
| tar -xvf archive.tar -C /tmp | распаковать архив в /tmp |
| tar -xvfz archive.tar.gz | разжать архив и распаковать его |
| zip file1.zip file1 | создать сжатый zip-архив |
| zip -r file1.zip file1 file2 dir1 | создать сжатый zip-архив и со включением в него нескольких файлов и/или директорий |
| unzip file1.zip | разжать и распаковать zip-архив |
| zipinfo file.zip | информация по архиву |
| unzip all.zip file.txt -d . | распаковать из архива только файл file.txt


### DEB пакеты
| Команда | Описание |
| --- | --- |
| dpkg -i package.deb | установить / обновить пакет |
| dpkg -r package_name | удалить пакет из системы |
| dpkg -l | показать все пакеты, установленные в систему |
| dpkg -l &#124; grep httpd | среди всех пакетов, установленных в системе, найти пакет содержащий в своём имени "httpd" |
| dpkg -s package_name | отобразить инфрмацию о конкретном пакете |
| dpkg -L package_name | вывести список файлов, входящих в пакет, установленный в систему |
| dpkg --contents package.deb | отобразить список файлов, входящих в пакет, который ешё не установлен в систему |
| dpkg -S /bin/ping | найти пакет, в который входит указанный файл. |


### APT - средство управление пакетами
| Команда | Описание |
| --- | --- |
| apt-get install package_name | установить / обновить пакет |
| apt-get update | получить обновлённые списки пакетов |
| apt-get upgrade | обновить пакеты, установленные в систему |
| apt-get remove package_name | удалить пакет, установленный в систему с сохранением файлов конфигурации |
| apt-get purge package_name | удалить пакет, установленный в систему с удалением файлов конфигурации |
| apt-get check | проверить целостность зависимостей |
| apt-get clean | удалить загруженные архивные файлы пакетов |
| apt-get autoclean | удалить старые загруженные архивные файлы пакетов |


### Просмотр содержимого файлов
| Команда | Описание |
| --- | --- |
| cat file1 | вывести содержимое файла file1 на стандартное устройсво вывода |
| tac file1 | вывести содержимое файла file1 на стандартное устройсво вывода в обратном порядке (последняя строка становится первой и т.д.) |
| more file1 | постраничный вывод содержимого файла file1 на стандартное устройство вывода |
| less file1 | постраничный вывод содержимого файла file1 на стандартное устройство вывода, но с возможностью пролистывания в обе стороны (вверх-вниз), поиска по содержимому и т.п. |
| head -2 file1 | вывести первые две строки файла file1 на стандартное устройство вывода. По-умолчанию выводится десять строк |
| tail -2 file1 | вывести последние две строки файла file1 на стандартное устройство вывода. По-умолчанию выводится десять строк |
| tail -f /var/log/messages | выводить содержимое файла /var/log/messages на стандартное устройство вывода по мере появления в нём текста. |


###Манипуляции с текстом
| Команда | Описание |
| --- | --- |
| cat file &#124; grep -i "Criteria" > result.txt | общий синтаксис выполнения действий по обработке содержимого файла и вывода результата в новый |
| cat file &#124; grep -i "Criteria" >> result.txt | общий синтаксис выполнения действий по обработке содержимого файла и вывода результата в существующий файл. Если файл не существует, он будет создан |
| grep Aug /var/log/messages | из файла '/var/log/messages' отобрать и вывести на стандартное устройство вывода строки, содержащие "Aug" |
| grep ^Aug /var/log/messages | из файла '/var/log/messages' отобрать и вывести на стандартное устройство вывода строки, начинающиеся на "Aug" |
| grep -e '[0-9]' /var/log/messages | из файла '/var/log/messages' отобрать и вывести на стандартное устройство вывода строки, содержащие цифры |
| grep Aug -R /var/log/* | отобрать и вывести на стандартное устройство вывода строки, содержащие "Aug", во всех файлах, находящихся в директории /var/log и ниже |
| sed 's/stringa1/stringa2/g' example.txt | в файле example.txt заменить "string1" на "string2", результат вывести на стандартное устройство вывода. |
| sed '/^$/d' example.txt | удалить пустые строки из файла example.txt |
| sed '/ *#/d; /^$/d' example.txt | удалить пустые строки и комментарии из файла example.txt |
| echo 'test' &#124; tr '[:lower:]' '[:upper:]' | преобразовать символы из нижнего регистра в верхний |
| sed -e '1d' result.txt | удалить первую строку из файла example.txt |
| sed -n '/string1/p' | отобразить только строки содержашие "string1" |
| sed -e 's/ *$//' example.txt | удалить пустые символы в в конце каждой строки |
| sed -e 's/string1//g' example.txt | удалить строку "string1" из текста не изменяя всего остального |
| sed -n '1,8p;5q' example.txt | взять из файла с первой по восьмую строки и из них вывести первые пять |
| sed -n '5p;5q' example.txt | вывести пятую строку |
| sed -e 's/0*/0/g' example.txt | заменить последовательность из любого количества нулей одним нулём |
| cat -n file1 | пронумеровать строки при выводе содержимого файла |
| cat example.txt &#124; awk 'NR%2==1' | при выводе содержимого файла, не выводить чётные строки файла |
| echo a b c &#124; awk '{print $1}' | вывести первую колонку. Разделение, по-умолчанию, по проблелу/пробелам или символу/символам табуляции |
| echo a b c &#124; awk '{print $1,$3}' | вывести первую и треью колонки. Разделение, по-умолчанию, по проблелу/пробелам или символу/символам табуляции |
| paste file1 file2 | объединить содержимое file1 и file2 в виде таблицы: строка 1 из file1 = строка 1 колонка 1-n, строка 1 из file2 = строка 1 колонка n+1-m |
| paste -d '+' file1 file2 | объединить содержимое file1 и file2 в виде таблицы с разделителем "+" |
| sort file1 file2 | отсортировать содержимое двух файлов |
| sort file1 file2 &#124; uniq | отсортировать содержимое двух файлов, не отображая повторов |
| sort file1 file2 &#124; uniq -u | отсортировать содержимое двух файлов, отображая только уникальные строки (строки, встречающиеся в обоих файлах, не выводятся на стандартное устройство вывода) |
| sort file1 file2 &#124; uniq -d | отсортировать содержимое двух файлов, отображая только повторяющиеся строки |
| comm -1 file1 file2 | сравнить содержимое двух файлов, не отображая строки принадлежащие файлу 'file1' |
| comm -2 file1 file2 | сравнить содержимое двух файлов, не отображая строки принадлежащие файлу 'file2' |
| comm -3 file1 file2 | сравнить содержимое двух файлов, удаляя строки встречающиеся в обоих файлах |


### Преобразование наборов символов и файловых форматов
| Команда | Описание |
| --- | --- |
| dos2unix filedos.txt fileunix.txt | конвертировать файл текстового формата из MSDOS в UNIX (разница в символах возврата коретки) |
| unix2dos fileunix.txt filedos.txt | конвертировать файл текстового формата из UNIX в MSDOS (разница в символах возврата коретки) |


### Анализ файловых систем
| Команда | Описание |
| --- | --- |
| badblocks -v /dev/hda1 | проверить раздел hda1 на наличие bad-блоков |
| fsck /dev/hda1 | проверить/восстановить целостность linux-файловой системы раздела hda1 |
| fsck.ext2 /dev/hda1 | проверить/восстановить целостность файловой системы ext2 раздела hda1 |
| e2fsck /dev/hda1 |
| e2fsck -j /dev/hda1 | проверить/восстановить целостность файловой системы ext3 раздела hda1 с указанием, что журнал расположен там же |
| fsck.ext3 /dev/hda1 | проверить/восстановить целостность файловой системы ext3 раздела hda1 |
| fsck.vfat /dev/hda1 | проверить/восстановить целостность файловой системы fat раздела hda1 |
| fsck.msdos /dev/hda1 | проверить/восстановить целостность файловой системы fat раздела hda1 |
| dosfsck /dev/hda1 | проверить/восстановить целостность файловой системы fat раздела hda1 |
[//]: # (TODO опробовать команды)


### Форматирование файловых систем
| Команда | Описание |
| --- | --- |
| mkfs /dev/hda1 | создать linux-файловую систему на разделе hda1 |
| mke2fs /dev/hda1 | создать файловую систему ext2 на разделе hda1 |
| mke2fs -j /dev/hda1 | создать журналирующую файловую систему ext3 на разделе hda1 |
| mkfs -t vfat 32 -F /dev/hda1 | создать файловую систему FAT32 на разделе hda1 |
| mkswap /dev/hda3 | создание swap-пространства на разделе hda3 |
[//]: # (TODO опробовать команды)


### swap-пространство
| Команда | Описание |
| --- | --- |
| mkswap /dev/hda3 | создание swap-пространства на разделе hda3 |
| swapon /dev/hda3 | активировать swap-пространство, расположенное на разделе hda3 |
| swapon /dev/hda2 /dev/hdb3 | активировать swap-пространства, расположенные на разделах hda2 и hdb3 |
[//]: # (TODO опробовать команды)
